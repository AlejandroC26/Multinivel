(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b82475c8"],{"4b48":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"application-container"},[e("Aside"),e("main",[e("h1",[t._v("Comisiones Cargadas")]),t.sale_point.id?e("div",{staticClass:"info-card"},[e("p",[t._v("Datos generales")]),e("hr"),e("div",{staticClass:"row mb-2"},[e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"row mb-2"},[t._m(0),e("div",{staticClass:"col-md-6"},[e("b",[t._v(t._s(t.sale_point.name))])])]),e("div",{staticClass:"row mb-2"},[t._m(1),e("div",{staticClass:"col-md-6"},[e("b",[t._v("$"+t._s(t.formatMoney(t.sale_point.total_com)[0])+","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.sale_point.total_com)[1]))])])])]),e("div",{staticClass:"row mb-2",staticStyle:{"text-decoration":"underline",cursor:"pointer"},on:{click:function(a){return t.showPayments()}}},[t._m(2),e("div",{staticClass:"col-md-6"},[e("b",[t._v("$"+t._s(t.formatMoney(t.sale_point.payments)[0])+","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.sale_point.payments)[1]))])])])]),e("div",{staticClass:"row mb-2"},[t._m(3),e("div",{staticClass:"col-md-6"},[e("b",[t._v("$"+t._s(t.formatMoney(t.sale_point.pending_payments)[0])+","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.sale_point.pending_payments)[1]))])])])])]),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"accordion",staticStyle:{"max-height":"200px","overflow-y":"scroll"},attrs:{id:"accordion"}},t._l(t.commissions,(function(a,s){return e("div",{key:a.year,staticClass:"card"},[e("div",{staticClass:"card-header",attrs:{id:"heading-"+s}},[e("h2",{staticClass:"mb-0"},[e("button",{staticClass:"btn btn-link btn-block text-left collapsed",attrs:{type:"button","data-toggle":"collapse","data-target":"#collapse-"+s,"aria-expanded":"false","aria-controls":"collapse-"+s}},[e("p",[e("strong",[t._v(t._s(a.year)+" | $ "+t._s(t.formatMoney(a.money)[0])+" ")])])])])]),e("div",{staticClass:"collapse",attrs:{id:"collapse-"+s,"aria-labelledby":"heading-"+s,"data-parent":"#accordion"}},[e("div",{staticClass:"card-body",staticStyle:{padding:".5rem .5rem"}},t._l(a.months,(function(a){return e("div",{key:a.month,staticClass:"accordion-body",staticStyle:{padding:".3rem 1.5rem"}},[e("div",{staticClass:"row",staticStyle:{"font-size":".9rem"}},[e("div",{staticClass:"col"},[t._v(t._s(t.formatMonth(a.month)))]),e("div",{staticClass:"col"},[t._v("$"+t._s(t.formatMoney(a.money)[0]))])])])})),0)])])})),0)])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"}),e("div",{staticClass:"col-md-6"},[t.session_user.pages.aliance_createpayment?e("button",{staticClass:"btn btn-danger",staticStyle:{width:"100%"},on:{click:function(a){return t.showModalPayment()}}},[t._v("Realizar Pago")]):t._e()])])]):e("div",{staticClass:"info-card"},[t._m(4)]),t._m(5)]),e("Right"),e("div",{staticClass:"modal fade",attrs:{id:"modal-payment",tabindex:"-1","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[t._m(6),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[t._m(7),e("div",{staticClass:"col-8"},[t._v(t._s(t.sale_point.name))]),t._m(8),e("div",{staticClass:"col-8"},[e("b",[t._v("$"+t._s(t.formatMoney(t.sale_point.pending_payments)[0])+","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.sale_point.pending_payments)[1]))])])])]),e("div",{staticClass:"row mt-3"},[e("div",{staticClass:"col-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.payment,expression:"payment"}],staticClass:"form-control",attrs:{type:"number",placeholder:"$"},domProps:{value:t.payment},on:{input:function(a){a.target.composing||(t.payment=a.target.value)}}})]),e("div",{staticClass:"col-4"},[e("button",{staticClass:"btn btn-danger",staticStyle:{width:"100%"},on:{click:function(a){return t.payCommission()}}},[t._v("Pagar")])])])])])])]),t._m(9)],1)},i=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-md-6"},[e("p",[t._v("Nombre")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-md-6"},[e("p",[t._v("Total Comisión")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-md-6"},[e("p",[t._v("Total Pagos")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-md-6"},[e("p",[t._v("Pagos Pendientes")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{display:"flex","justify-content":"center"}},[e("div",{staticClass:"lds-dual-ring"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"info-card"},[e("p",[t._v("Últimas comisiones")]),e("hr"),e("table",{staticClass:"table table-stripped",attrs:{id:"last_comm_table"}},[e("thead",[e("tr",[e("th",[t._v("Código")]),e("th",[t._v("Nombre")]),e("th",[t._v("Documento")]),e("th",[t._v("Monto")]),e("th",[t._v("Fecha")])])])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal-header"},[e("h3",{staticClass:"modal-title"},[e("p",[t._v("Cancelar Comisión")])]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-4"},[e("p",[t._v("Código")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-4"},[e("p",[t._v("Pagos Pendientes")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal fade",attrs:{id:"modal-payments",tabindex:"-1","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h3",{staticClass:"modal-title"},[t._v(" PAGOS REALIZADOS ")]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),e("div",{staticClass:"modal-body"},[e("table",{staticClass:"table table-striped",staticStyle:{border:"none"},attrs:{id:"table-payments"}},[e("thead",[e("tr",[e("th",[t._v("Pago")]),e("th",[t._v("Fecha")])])])])])])])])}],o=e("5530"),n=(e("99af"),e("b0c0"),e("d3b7"),e("159b"),e("ac1f"),e("1276"),e("b65f"),e("bc3a")),l=e.n(n),c=e("2f62"),r=e("3d13"),d=e("8084"),m={name:"CommissionsCharged",components:{Aside:r["a"],Right:d["a"]},data:function(){return{payment:"",sales:[]}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({payCommission:function(){var t=this;return this.payment<=0?this.launchAlert({type:"warning",title:"Digita un valor válido"}):this.payment>this.sale_point.pending_payments?this.launchAlert({type:"warning",title:"Valor digitado supera la deuda del punto"}):void this.$swal.fire({title:"¿Estás seguro que deseas realizar este pago?",html:"Realizar pago <b>$".concat(this.formatMoney(this.payment)[0],',<label style="font-size: .9rem;">').concat(this.formatMoney(this.payment)[1],"</label></b> \n                a ").concat(this.sale_point.name),showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"}).then((function(a){if(a.isConfirmed){var e=t.api_url+"/api/salepoints/".concat(t.sale_point.id,"/payment");l.a.post(e,{money:t.payment},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(a){if(201==a.status)return t.payment="",$("#modal-payment").modal("hide"),t.loadSalePoint(t.$route.params.id),t.launchAlert({type:"success",title:"Pago realizado exitosamente"})}))}}))},showPayments:function(){var t=this;$("#modal-payments").modal("show"),this.searchPayments({id:this.sale_point.id}).then((function(a){var e=[];a.data.forEach((function(a){var s="$".concat(t.formatMoney(a.money)[0],',<label style="font-size: .8rem;">').concat(t.formatMoney(a.money)[1],"</label>"),i=t.formatHourDate(a.created_at),o={commission:s,created_at:i};e.push(o)})),$("#table-payments").DataTable({responsive:!0,autoWidth:!1,lengthChange:!1,info:!1,destroy:!0,data:e,columns:[{data:"commission"},{data:"created_at"}]})}))},searchSales:function(t){var a=this,e=this.api_url+"/api/search/sales";l.a.post(e,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(t){a.sales=t.data,a.loadTableCommInfo(a.sales)})).catch((function(t){return console.log(t.response)}))},loadTableCommInfo:function(t){var a=this,e=[];t.forEach((function(t){var s="$".concat(a.formatMoney(t.commission)[0],',<label style="font-size: .8rem;">').concat(a.formatMoney(t.commission)[1],"</label>"),i=a.formatDate(t.created_at),o={client_user_id:t.client_user_id,client_user_name:t.client_user_name,client_user_id_card:t.client_user_id_card,commission:s,created_at:i};e.push(o)})),$("#last_comm_table").DataTable({autoWidth:!1,responsive:!0,lengthChange:!1,info:!1,destroy:!0,data:e,columns:[{data:"client_user_id"},{data:"client_user_name"},{data:"client_user_id_card"},{data:"commission"},{data:"created_at"}]})},formatMonth:function(t){var a="";switch(t){case 1:a="Enero";break;case 2:a="Febrero";break;case 3:a="Marzo";break;case 4:a="Abril";break;case 5:a="Mayo";break;case 6:a="Junio";break;case 7:a="Julio";break;case 8:a="Agosto";break;case 9:a="Septiembre";break;case 10:a="Octubre";break;case 11:a="Noviembre";break;case 12:a="Diciembre";break}return a},formatMoney:function(t){var a=new Intl.NumberFormat("em-IN").format(t),e=a.split(","),s=e[1];return s||(s="00"),window.innerWidth<=838?[Math.trunc(t),"00"]:[e[0],s]},formatHourDate:function(t){var a=new Date(t),e=a.getFullYear(),s=a.getMonth()+1,i=a.getDate(),o=a.getHours(),n=a.getMinutes();return s<10&&(s="0"+s),i<10&&(i="0"+i),"".concat(e,"-").concat(s,"-").concat(i," ").concat(o,":").concat(n)},formatDate:function(t){var a=new Date(t),e=a.getFullYear(),s=a.getMonth()+1,i=a.getDate(),o=a.getHours(),n=a.getMinutes();return s<10&&(s="0"+s),i<10&&(i="0"+i),"".concat(e,"-").concat(s,"-").concat(i," ").concat(o,":").concat(n)},launchAlert:function(t){t.timeout||(t.timeout=2500);var a=this.$swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:t.timeout});a.fire({icon:t.type,title:t.title,text:t.message})},showModalPayment:function(){$("#modal-payment").modal("show")}},Object(c["b"])("user",["getUsersLine"])),Object(c["b"])("sale_point",["searchPayments"])),Object(c["c"])(["loadSessionUser"])),Object(c["c"])("sale_point",["loadSalePoint"])),Object(c["c"])("sale_point",["loadCommissions"])),mounted:function(){$(".modal-backdrop").remove(),this.loadSessionUser(),this.loadSalePoint(this.$route.params.id),this.loadCommissions(this.$route.params.id),this.searchSales({sale_point:this.$route.params.id})},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(c["d"])(["api_url"])),Object(c["d"])(["session_user"])),Object(c["d"])("sale_point",["sale_point"])),Object(c["d"])("sale_point",["commissions"])),watch:{"$route.params.id":function(){this.loadSalePoint(this.$route.params.id),this.loadCommissions(this.$route.params.id),this.searchSales({sale_point:this.$route.params.id})}}},u=m,_=e("0c7c"),p=Object(_["a"])(u,s,i,!1,null,null,null);a["default"]=p.exports},b65f:function(t,a,e){var s=e("23e7"),i=Math.ceil,o=Math.floor;s({target:"Math",stat:!0},{trunc:function(t){return(t>0?o:i)(t)}})}}]);
//# sourceMappingURL=chunk-b82475c8.48fbc887.js.map