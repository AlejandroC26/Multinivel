(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4305578a"],{b65f:function(t,a,e){var s=e("23e7"),o=Math.ceil,i=Math.floor;s({target:"Math",stat:!0},{trunc:function(t){return(t>0?i:o)(t)}})},f94e:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"application-container"},[e("Aside"),e("main",[e("h1",[t._v("Comisiones")]),e("div",{staticClass:"info-card"},[e("p",[t._v("Datos Generales")]),e("hr",{staticStyle:{color:"var(--color-dark)"}}),t.comm_data.loaded?e("div",[e("div",{staticClass:"row"},[t._m(0),e("div",{staticClass:"col-sm-8"},[t._v(" $"+t._s(t.formatMoney(t.comm_data.total_comm_money)[0])+","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.comm_data.total_comm_money)[1]))])])]),e("div",{staticClass:"row"},[t._m(1),e("div",{staticClass:"col-sm-8"},[e("label",[t._v("$"+t._s(t.formatMoney(t.comm_data.users_comm_money)[0]))]),t._v(","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.comm_data.users_comm_money)[1]))])])]),e("div",{staticClass:"row mb-2"},[t._m(2),e("div",{staticClass:"col-sm-8"},[t._v(" $"+t._s(t.formatMoney(t.comm_data.pending_coms_money)[0])+","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.comm_data.pending_coms_money)[1]))])])]),t.session_user.pages.payment?e("div",{staticClass:"row mt-1",staticStyle:{"text-decoration":"underline",cursor:"pointer"},on:{click:function(a){return t.showPayments()}}},[t._m(3),e("div",{staticClass:"col-sm-8"},[e("label",[t._v("$"+t._s(t.formatMoney(t.comm_data.total_payments_money)[0]))]),t._v(","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.comm_data.total_payments_money)[1]))])])]):e("div",{staticClass:"row mt-1"},[t._m(4),e("div",{staticClass:"col-sm-8"},[e("label",[t._v("$"+t._s(t.formatMoney(t.comm_data.total_payments_money)[0]))]),t._v(","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.comm_data.total_payments_money)[1]))])])]),e("div",{staticClass:"row mt-1",staticStyle:{"text-decoration":"underline",cursor:"pointer"},on:{click:function(a){return t.showCompanyCom()}}},[t._m(5),e("div",{staticClass:"col-sm-8"},[e("label",[t._v("$"+t._s(t.formatMoney(t.comm_data.company_comm_money)[0]))]),t._v(","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.comm_data.company_comm_money)[1]))])])])]):e("div",[t._m(6)])]),e("div",{staticClass:"info-card"},[e("p",[t._v("Lista de Usuarios")]),e("hr"),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12 mb-3"},[e("small",[t._v("Tipo de búsqueda")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.type_search,expression:"type_search"}],staticClass:"form-control",attrs:{name:""},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.type_search=a.target.multiple?e:e[0]}}},[e("option",{attrs:{value:"code"}},[t._v("Código")]),e("option",{attrs:{value:"card"}},[t._v("Documento")]),e("option",{attrs:{value:"name"}},[t._v("Nombre")]),e("option",{attrs:{value:"email"}},[t._v("Correo")])])]),e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"input-group mb-3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Búsqueda..."},domProps:{value:t.search},on:{input:function(a){a.target.composing||(t.search=a.target.value)}}}),t._m(7)])])]),t.loaded_comm?e("table",{staticClass:"table"},[t._m(8),e("tbody",t._l(t.commissions,(function(a,s){return e("tr",{key:s},[e("td",[t._v(t._s(a.user_id||"-"))]),e("td",[t._v(t._s(a.user_name||"Comercializadora 3B"))]),e("td",[t._v(t._s(a.id_card||"---"))]),e("td",[t._v("$"+t._s(t.formatMoney(a.money)[0])+","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(a.money)[1]))])]),e("td",[e("router-link",{staticClass:"btn btn-secondary",staticStyle:{display:"inline-flex","align-items":"center"},attrs:{to:"/cartera/"+a.user_id}},[e("span",{staticClass:"material-icons-sharp active",staticStyle:{"font-size":"1.2rem"}},[t._v("wallet")])]),t.session_user.pages.commision_payment?e("a",{staticClass:"btn btn-danger",staticStyle:{display:"inline-flex","align-items":"center"},on:{click:function(e){return t.showModalPayment(a)}}},[e("span",{staticClass:"material-icons-sharp active",staticStyle:{"font-size":"1.2rem"}},[t._v("point_of_sale")])]):t._e()],1)])})),0)]):e("div",[t._m(9)])])]),e("Right"),t._m(10),e("div",{staticClass:"modal fade",attrs:{id:"modal-payment",tabindex:"-1","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[t._m(11),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[t._m(12),e("div",{staticClass:"col-8"},[t._v(t._s(t.commission.user_id))]),t._m(13),e("div",{staticClass:"col-8"},[t._v(t._s(t.commission.user_name))]),t._m(14),e("div",{staticClass:"col-8"},[t._v("$"+t._s(t.formatMoney(t.commission.money)[0])+","),e("label",{staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.formatMoney(t.commission.money)[1]))])])]),e("div",{staticClass:"row mt-3"},[e("div",{staticClass:"col-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.payment_money,expression:"payment_money"}],staticClass:"form-control",attrs:{type:"number",placeholder:"$"},domProps:{value:t.payment_money},on:{input:function(a){a.target.composing||(t.payment_money=a.target.value)}}})]),e("div",{staticClass:"col-4"},[e("button",{staticClass:"btn btn-danger",staticStyle:{width:"100%"},on:{click:function(a){return t.payCommission()}}},[t._v("Pagar")])])])])])])]),t._m(15)],1)},o=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-sm-4"},[e("p",[t._v("Comisiones Generadas")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-sm-4"},[e("p",[t._v("Comisiones Usuarios")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-sm-4"},[e("p",[t._v("Comisiones Pendientes")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-sm-4"},[e("p",[t._v("Comisiones Pagadas")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-sm-4"},[e("p",[t._v("Comisiones Pagadas")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-sm-4"},[e("p",[t._v("Comisiones Empresa")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{display:"flex","justify-content":"center"}},[e("div",{staticClass:"lds-dual-ring"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"input-group-append"},[e("button",{staticClass:"input-group-text",attrs:{type:"submit"}},[e("span",{staticClass:"material-icons-sharp"},[t._v("search")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("Código")]),e("th",[t._v("Nombre")]),e("th",[t._v("Documento")]),e("th",[t._v("Comisión")]),e("th",[t._v("Acción")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{display:"flex","justify-content":"center"}},[e("div",{staticClass:"lds-dual-ring"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal fade",attrs:{id:"modal-company-com",tabindex:"-1","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h3",{staticClass:"modal-title"},[t._v(" COMISIONES DE EMPRESA ")]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),e("div",{staticClass:"modal-body"},[e("table",{staticClass:"table table-striped",staticStyle:{border:"none"},attrs:{id:"table-company-commissions"}},[e("thead",[e("tr",[e("th",[t._v("Punto Venta")]),e("th",[t._v("Cliente")]),e("th",[t._v("Ganancia")]),e("th",[t._v("Fecha")])])])])])])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal-header"},[e("h3",{staticClass:"modal-title"},[e("p",[t._v("Cancelar Comisión")])]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-4"},[e("p",[t._v("Código")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-4"},[e("p",[t._v("Nombre")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-4"},[e("p",[t._v("Dinero")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal fade",attrs:{id:"modal-payments",tabindex:"-1","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h3",{staticClass:"modal-title"},[t._v(" PAGOS REALIZADOS ")]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),e("div",{staticClass:"modal-body"},[e("table",{staticClass:"table table-striped",staticStyle:{border:"none"},attrs:{id:"table-payments"}},[e("thead",[e("tr",[e("th",[t._v("Documento")]),e("th",[t._v("Cliente")]),e("th",[t._v("Dinero")]),e("th",[t._v("Fecha")])])])])])])])])}],i=e("5530"),n=(e("99af"),e("d3b7"),e("159b"),e("ac1f"),e("1276"),e("b65f"),e("841c"),e("2f62")),c=e("3d13"),r=e("8084"),m={name:"",data:function(){return{search:"",type_search:"code",payment_money:"",commission:{user_id:"",user_name:"",user_id_card:"",money:""},loaded_comm:!1,commissions:[]}},components:{Aside:c["a"],Right:r["a"]},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])({payCommission:function(){var t=this;if(this.payment_money>this.commission.money)return this.launchAlert({type:"warning",title:"El pago excede la cartera del usuario"});this.$swal.fire({title:"¿Estás seguro que deseas realizar este pago?",html:"Realizar pago <b>$".concat(this.formatMoney(this.payment_money)[0],',<label style="font-size: .9rem;">').concat(this.formatMoney(this.payment_money)[1],"</label></b> a \n                <b>").concat(this.commission.user_name,"</b>"),showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"}).then((function(a){if(a.isConfirmed){var e={user_id:t.commission.user_id,money:t.payment_money};t.paymentCommission(e).then((function(a){return 201==a.status?(t.infoCommissions(),t.loadCommissionsUsers(),t.payment_money="",$("#modal-payment").modal("hide"),t.launchAlert({type:"success",title:"Comisión pagada exitosamente"})):console.log(a)})).catch((function(t){console.log(t.response)}))}}))},loadCommissionsUsers:function(){var t=this;this.searchCommissions({group_by:"user_id",order:"ASC",limit:10}).then((function(a){t.loaded_comm=!0,t.commissions=a.data})).catch((function(t){return console.log(t.response)}))},renderTableSearch:function(t){var a=this;this.searchCommissions(t).then((function(t){a.loaded_comm=!0,a.commissions=t.data})).catch((function(t){return console.log(t.response)}))},showModalPayment:function(t){this.commission.user_id=t.user_id,this.commission.user_name=t.user_name,this.commission.user_id_card=t.user_id_card,this.commission.money=t.money,$("#modal-payment").modal("show")},showPayments:function(){var t=this;$("#modal-payments").modal("show"),this.searchPayments().then((function(a){var e=[];a.data.forEach((function(a){var s="$".concat(t.formatMoney(a.money)[0],',<label style="font-size: .8rem;">').concat(t.formatMoney(a.money)[1],"</label>"),o=t.formatHourDate(a.created_at),i={user_id_card:a.id_card,user_name:a.user_name,commission:s,created_at:o};e.push(i)})),$("#table-payments").DataTable({responsive:!0,autoWidth:!1,lengthChange:!1,info:!1,destroy:!0,data:e,columns:[{data:"user_id_card"},{data:"user_name"},{data:"commission"},{data:"created_at"}]})}))},showCompanyCom:function(){var t=this;$("#modal-company-com").modal("show"),this.searchCommissions({type:"company"}).then((function(a){var e=[];a.data.forEach((function(a){var s="$".concat(t.formatMoney(a.money)[0],',<label style="font-size: .8rem;">').concat(t.formatMoney(a.money)[1],"</label>"),o=t.formatDate(a.created_at),i={sale_point_name:a.sale_point_name,client_user_name:a.client_user_name,commission:s,created_at:o};e.push(i)})),$("#table-company-commissions").DataTable({responsive:!0,autoWidth:!1,lengthChange:!1,info:!1,destroy:!0,data:e,columns:[{data:"sale_point_name"},{data:"client_user_name"},{data:"commission"},{data:"created_at"}]})})).catch((function(t){return console.log(t.response)}))},formatMoney:function(t){var a=new Intl.NumberFormat("em-IN").format(t),e=a.split(","),s=e[1];return s||(s="00"),window.innerWidth<=838?[Math.trunc(t),"00"]:[e[0],s]},formatHourDate:function(t){var a=new Date(t),e=a.getFullYear(),s=a.getMonth()+1,o=a.getDate(),i=a.getHours(),n=a.getMinutes();return s<10&&(s="0"+s),o<10&&(o="0"+o),"".concat(e,"-").concat(s,"-").concat(o," ").concat(i,":").concat(n)},formatDate:function(t){var a=new Date(t),e=a.getFullYear(),s=a.getMonth()+1,o=a.getDate();return s<10&&(s="0"+s),o<10&&(o="0"+o),e+"/"+s+"/"+o},launchAlert:function(t){t.timeout||(t.timeout=2500);var a=this.$swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:t.timeout});a.fire({icon:t.type,title:t.title,text:t.message})}},Object(n["b"])("user",["getUsersLine"])),Object(n["c"])(["loadSessionUser"])),Object(n["c"])("commission",["infoCommissions"])),Object(n["b"])("commission",["searchPayments"])),Object(n["b"])("commission",["searchCommissions"])),Object(n["b"])("commission",["paymentCommission"])),mounted:function(){var t=this;$(".modal-backdrop").remove(),this.loadSessionUser(),this.infoCommissions();var a=setInterval((function(){if(t.session_user.id)return t.loadCommissionsUsers(),clearInterval(a)}),100)},computed:Object(i["a"])(Object(i["a"])({},Object(n["d"])(["session_user"])),Object(n["d"])("commission",["comm_data"])),watch:{search:function(){this.renderTableSearch({search:this.search,type_search:this.type_search,group_by:"user_id",order:"ASC",limit:10})}}},l=m,d=e("0c7c"),_=Object(d["a"])(l,s,o,!1,null,null,null);a["default"]=_.exports}}]);
//# sourceMappingURL=chunk-4305578a.51b89865.js.map